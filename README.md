# WooYun Legacy

> 88636个真实漏洞，教会我们的事

## 这是什么

这是一个 **Claude Code Skill**，基于 WooYun 2010-2016 年间收录的 88,636 个真实漏洞案例，提炼出的安全知识库。

装上这个 Skill 后，Claude 能像资深安全专家一样思考漏洞问题。

## 知识库规模

- **漏洞总数**: 88,636 个
- **知识容量**: 86MB / 约200万行
- **覆盖类型**: 15种漏洞类型

## 漏洞分布

| 类型 | 占比 |
|------|------|
| SQL注入 | 27% |
| 命令执行 | 19% |
| XSS | 11% |
| 未授权访问 | 8% |
| 弱口令 | 8% |
| 其他 | 27% |

## 目录结构

```
├── SKILL.md           # 主技能文件
├── PROGRESS.md        # 处理进度记录
├── knowledge/         # 精炼知识库（方法论）
├── categories/        # 完整案例库（86MB）
│   ├── sql-injection.md
│   ├── command-execution.md
│   ├── xss.md
│   └── ...
└── examples/          # 行业渗透测试示例
    ├── README.md
    ├── telecom-penetration.md
    └── bank-penetration.md
```

## 行业渗透示例

`examples/` 目录包含基于真实安全研究问题生成的行业渗透测试方法论。以下是完整的问答示例：

---

### 示例一：运营商渗透

> **提问**：请你思考告诉我运营商有哪些常见的漏洞？有哪些不常见的攻击面，如何实现getshell?

<details>
<summary><b>📖 点击展开完整回复</b></summary>

#### 一、运营商常见漏洞分类

##### 1. 弱口令问题（最高频）

| 系统类型 | 常见默认凭证 | 风险等级 |
|---------|------------|---------|
| 网络设备 | admin/admin, root/root | 🔴 高危 |
| 业务系统后台 | admin/123456, test/test | 🔴 高危 |
| 数据库 | sa/空密码, root/root | 🔴 高危 |
| BOSS 系统 | 工号/工号, 工号/123456 | 🔴 高危 |
| 运维平台 | operator/operator | 🔴 高危 |

##### 2. 越权漏洞（业务逻辑层）

```
典型场景：
├── 水平越权：查看/修改他人套餐、话费、通话记录
├── 垂直越权：普通用户 → 客服权限 → 管理员权限
└── 接口越权：手机号遍历获取用户信息
```

**关键参数**：
- `phone_number` / `mobile` - 手机号码
- `user_id` / `cust_id` - 用户标识
- `order_id` - 订单编号
- `bill_id` - 账单编号

##### 3. 信息泄露

| 泄露类型 | 案例数 | 影响范围 |
|---------|-------|---------|
| 用户信息泄露 | 高 | 姓名、身份证、住址、通话记录 |
| 系统配置泄露 | 中 | 数据库连接串、内部 IP |
| 接口文档泄露 | 中 | Swagger、API 文档外泄 |
| 备份文件泄露 | 中 | .bak, .sql, .tar.gz |

#### 二、不常见但高价值的攻击面

##### 1. 🎯 增值业务平台

```
攻击链路：
SP/CP 合作平台 → 业务接口 → 计费系统 → BOSS 核心
                    ↓
              短信网关/彩信平台
```

**切入点**：
- 第三方 SP 接入系统（安全要求往往较低）
- 短信/彩信下发平台
- 流量加油包/话费充值接口

##### 2. 🎯 网络管理系统（NMS）

```
常见暴露系统：
├── 网管平台（如华为 U2000/M2000）
├── 动环监控系统
├── 工单调度系统
└── 资源管理系统
```

**价值**：一旦突破，可控制核心网络设备

##### 3. 🎯 物联网卡管理平台

```
新兴攻击面：
├── IoT 设备管理后台
├── 物联网卡批量开通接口
├── M2M 平台
└── 车联网/智能家居接入点
```

##### 4. 🎯 内部 OA/ERP 系统

```
常见入口：
├── 员工自助门户（弱口令高发区）
├── 邮件系统（钓鱼/凭证泄露）
├── VPN 接入点
└── 云桌面/堡垒机
```

#### 三、GetShell 实现路径

##### 路径一：Web 应用层突破

```
1. 信息收集
   ├── 子域名枚举 → *.10086.cn, *.chinamobile.com
   ├── 端口扫描 → 非标准端口的管理后台
   └── 目录扫描 → /admin, /manager, /console

2. 漏洞利用（优先级排序）
   ├── [1] Struts2 RCE (S2-045/046/048/052)
   ├── [2] WebLogic 反序列化
   ├── [3] Shiro 反序列化 (rememberMe)
   ├── [4] Fastjson RCE
   ├── [5] 文件上传绕过
   └── [6] SQL 注入 → xp_cmdshell/into outfile
```

##### 路径二：边界设备突破

```
VPN 设备漏洞：
├── Pulse Secure CVE-2019-11510
├── Fortinet CVE-2018-13379
├── Citrix CVE-2019-19781
└── 深信服 VPN 任意密码重置

网络设备：
├── 华为设备默认密码
├── 思科 Smart Install 协议滥用
└── SNMP Community String 泄露 → 配置下载
```

##### 路径三：供应链攻击

```
突破路径：
第三方外包公司 → 开发测试环境 → 正式环境
        ↓
   运维人员电脑 → 内网横向移动
```

#### 四、横向移动与权限提升

```
GetShell 后的典型攻击链：

Web Shell
    ↓
内网信息收集（网段探测、存活主机）
    ↓
凭证获取（配置文件、内存 dump、浏览器凭证）
    ↓
横向移动（Pass the Hash、RDP、SSH）
    ↓
域控/核心数据库/BOSS 系统
```

**运营商特有的高价值目标**：

| 目标系统 | 价值 | 难度 |
|---------|-----|-----|
| BOSS 系统 | 用户数据、计费控制 | 高 |
| 认证中心（AAA） | 全网用户凭证 | 高 |
| 核心网设备 | 网络控制面 | 极高 |
| 短信网关 | 短信劫持 | 高 |
| DNS 服务器 | 流量劫持 | 中 |

#### 五、实战 Checklist

##### 信息收集阶段
- [ ] 子域名枚举（*.10086.cn, *.chinamobile.com 等）
- [ ] 端口扫描（重点非标准端口）
- [ ] 目录扫描（/admin, /api, /console）
- [ ] GitHub/Gitee 代码泄露
- [ ] 网络空间测绘（Shodan/Fofa/ZoomEye）

##### 漏洞发现阶段
- [ ] 弱口令爆破（Top 1000 + 运营商特定）
- [ ] 越权测试（手机号/用户 ID 遍历）
- [ ] 未授权访问（删除 Cookie 重放）
- [ ] 框架漏洞（Struts2/WebLogic/Shiro）
- [ ] SQL 注入 → 写 WebShell
- [ ] 文件上传绕过

##### GetShell 后
- [ ] 权限维持（计划任务/开机启动）
- [ ] 信息收集（网段/主机/服务）
- [ ] 凭证获取（配置文件/内存/浏览器）
- [ ] 代理隧道（出网探测/穿透搭建）
- [ ] 横向移动（PTH/SSH/RDP）
- [ ] 目标定位（BOSS/AAA/短信网关）

</details>

---

### 示例二：银行渗透

> **提问**：银行有哪些渗透思路？

<details>
<summary><b>📖 点击展开完整回复</b></summary>

#### 一、银行攻击面分层模型

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          第一层：互联网边界                              │
├─────────────────────────────────────────────────────────────────────────┤
│  网银系统 │ 手机银行 │ 微信银行 │ 直销银行 │ 信用卡中心 │ 官网/活动页   │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                          第二层：接口/通道层                             │
├─────────────────────────────────────────────────────────────────────────┤
│  支付接口 │ 银联通道 │ 快捷支付 │ 代扣代付 │ 聚合支付 │ 开放银行API     │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                          第三层：内部系统层                              │
├─────────────────────────────────────────────────────────────────────────┤
│  核心银行 │ 信贷系统 │ 风控系统 │ 反洗钱 │ 客户管理CRM │ 报表系统       │
└─────────────────────────────────────────────────────────────────────────┘
```

#### 二、高危漏洞类型

##### 第一梯队：资金类漏洞（68-88%高危）

| 漏洞类型 | 高危占比 | 银行特有场景 |
|---------|---------|-------------|
| 密码重置 | 88.0% | 网银/手机银行登录密码、交易密码 |
| 提现漏洞 | 83.1% | 转账限额绕过、提现校验缺陷 |
| 金额篡改 | 83.0% | 转账金额、理财金额、还款金额 |
| 支付漏洞 | 68.7% | 快捷支付、代扣代付、跨行转账 |

##### 支付漏洞检测（1056案例）

**手工测试清单**：
```
1. 修改金额参数：amount=0.01（测试服务端校验）
2. 修改数量为负数：quantity=-1（负数转账）
3. 重放成功的支付请求（测试幂等性）
4. 并发提交同一订单（条件竞争）
5. 修改收款账户/用户ID（越权转账）
6. 篡改回调通知（伪造支付成功）
```

**关键参数**：
- `amount` / `price` / `total` → 金额类
- `to_account` / `payee_id` → 收款方
- `sign` / `signature` → 签名

**绕过技巧**：
```
负数攻击：转账金额 = -1000
小数溢出：amount = 0.001
条件竞争：多线程并发转账
状态篡改：修改status=SUCCESS
签名绕过：删除/置空签名字段
```

#### 三、银行特有攻击面

##### 1. 手机银行APP安全

```
客户端安全
├── 反编译保护（加固强度）
├── 本地存储（敏感信息）
├── 日志泄露
└── 证书校验（SSL Pinning）

通信安全
├── 加密算法（密钥硬编码）
├── 请求签名（算法逆向）
└── 重放攻击

业务逻辑
├── 登录认证（密码/指纹/人脸）
├── 交易验证
└── 转账限额
```

**APP渗透思路**：
```
1. 抓包突破：绕过SSL Pinning（Frida/Objection）
2. 逆向分析：脱壳 → 签名算法逆向 → 密钥提取
3. Hook测试：绕过人脸/指纹验证、修改限额检测
```

##### 2. 网银系统

```
攻击思路：
├── ActiveX控件漏洞
├── 前端加密绕过（JS逆向）
├── 密码控件绕过
├── U盾驱动漏洞
├── 批量转账接口越权
└── 对账单/回单越权下载
```

##### 3. 第三方支付接口

```
攻击点：
├── 商户密钥泄露（GitHub搜索）
├── 回调验签缺陷
├── 异步通知重放
├── 金额校验缺失
└── 商户号越权
```

#### 四、验证绕过技巧

##### 短信验证码
```
├── 爆破（4-6位，可行）
├── 并发（绕过次数限制）
├── 复用（同一验证码多次使用）
├── 回显（响应中返回）
└── 万能验证码（0000/1234）
```

##### 人脸识别
```
├── 照片攻击
├── 视频攻击
├── Hook返回值
├── 接口重放
└── 替换人脸数据
```

##### 交易签名
```
├── 签名密钥硬编码
├── 未签名关键字段
├── 签名校验可选
└── 签名降级攻击
```

#### 五、渗透路径

##### 路径一：外部Web突破
```
信息收集 → 子域名/端口/指纹
    ↓
漏洞利用（优先级）：
├── 1. 弱口令爆破
├── 2. Struts2/WebLogic RCE
├── 3. 业务逻辑漏洞
└── 4. 文件上传/SQL注入
```

##### 路径二：移动端突破
```
静态分析 → 反编译、密钥搜索、API提取
动态分析 → 绕过Pinning、抓包、Hook
业务测试 → 登录/转账/密码重置
```

##### 路径三：供应链攻击
```
外包公司 → 代码/环境泄露
设备供应商 → 预置账号
服务提供商 → 短信/身份核验
```

#### 六、高价值目标

| 目标系统 | 价值 | 可做什么 |
|---------|-----|---------|
| 核心银行 | ⭐⭐⭐⭐⭐ | 账户余额、交易记录 |
| 信贷系统 | ⭐⭐⭐⭐ | 贷款审批、额度调整 |
| 风控系统 | ⭐⭐⭐⭐ | 黑名单、规则配置 |
| CRM系统 | ⭐⭐⭐ | KYC资料 |

#### 七、实战Checklist

##### 信息收集
- [ ] 子域名枚举
- [ ] GitHub代码泄露
- [ ] APP下载分析
- [ ] 微信公众号/小程序接口

##### 漏洞检测
- [ ] 弱口令测试
- [ ] 业务逻辑（支付/转账/密码重置）
- [ ] 越权测试
- [ ] 接口安全（签名/加密）
- [ ] APP客户端安全

##### 深度利用
- [ ] 支付金额篡改
- [ ] 验证码绕过
- [ ] 人脸识别绕过
- [ ] 并发条件竞争

</details>

---

## 使用方式

将本仓库克隆到 `~/.claude/skills/wooyun-legacy/`，然后在 Claude Code 中调用。

## 免责声明

⚠️ **本知识库仅供安全研究、教育培训、授权测试使用。**

严禁用于未经授权的渗透测试或任何违法活动。使用者需自行承担因不当使用而产生的法律责任。

## 加入社区

如果你对这个项目感兴趣，欢迎加入我们的微信交流群：

<p align="center">
  <img src="wechat-group.jpg" width="300" alt="微信群：探微杜渐科技">
</p>

<p align="center">
  <b>扫码加入「探微杜渐科技」交流群</b><br>
  <sub>一起探讨 AI + 安全的更多可能</sub>
</p>

> 💡 如果二维码过期，请关注公众号「探微杜渐人工智能」获取最新群二维码

## 致敬

致敬 WooYun 和那个时代的白帽子们。

---

*探微安全实验室出品*
